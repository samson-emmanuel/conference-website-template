{% extends 'base.html' %}

{% block content %}
<div id="profiles" style="display: flex; flex-wrap: wrap; gap: 20px;">
    {% for profile in profiles %}
    <div class="card" style="flex: 0 0 calc(50% - 20px); box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1); padding: 15px; margin-bottom: 20px; border-radius: 8px;">
        <img src="data:image/jpeg;base64,{{ profile['image'] }}" alt="{{ profile['NAME'] }}" style="width: 100%; height: auto; border-radius: 8px;">
        <h2>{{ profile['NAME'] }}</h2>
        <p>{{ profile['DESIGNATION'] }}</p>
        <p>{{ profile['FUNCTION'] }}</p>
        <p>{{ profile['LOCATION'] }}</p>
        <!-- Add more fields as needed -->
    </div>
    {% endfor %}
</div>
<button id="loadMore" data-start="10" style="margin: 20px 0; padding: 10px 20px; border: none; background-color: #007BFF; color: white; border-radius: 4px; cursor: pointer;">Load More</button>

<script>
    document.getElementById('loadMore').addEventListener('click', function() {
        var start = this.getAttribute('data-start');
        
        fetch('/load_more', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/x-www-form-urlencoded',
            },
            body: 'start=' + start
        })
        .then(response => response.json())
        .then(data => {
            var profilesDiv = document.getElementById('profiles');
            
            if (data.length === 0) {
                alert('No more profiles to load.');
                return;
            }
            
            data.forEach(profile => {
                var card = document.createElement('div');
                card.classList.add('card');
                card.style.cssText = "flex: 0 0 calc(50% - 20px); box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1); padding: 15px; margin-bottom: 20px; border-radius: 8px;";
                card.innerHTML = `
                    <img src="data:image/jpeg;base64,${profile['image']}" alt="${profile['NAME']}" style="width: 100%; height: auto; border-radius: 8px;">
                    <h2>${profile['NAME']}</h2>
                    <p>${profile['DESIGNATION']}</p>
                    <p>${profile['FUNCTION']}</p>
                    <p>${profile['LOCATION']}</p>
                `;
                profilesDiv.appendChild(card);
            });
            
            // Increment the data-start attribute
            this.setAttribute('data-start', parseInt(start) + 10);
        })
        .catch(error => {
            console.error('Error:', error);
            alert('Failed to load more profiles.');
        });
    });
</script>
{% endblock %}
